const fs = require('fs');

const delTargetDir = 'node_modules'
const glob = require('glob')
const enterTargetDir = 'D:/'

deleteTargetFolder(enterTargetDir, delTargetDir)

function deleteTargetFolder (path, target) {
    var files = []
    if (fs.existsSync(path)) {
        files = fs.readdirSync(path)
        console.log(files)
        files.forEach(function (file, index) {
            var curPath = path + "/" + file;
            console.log(curPath)
            if (fs.lstatSync(curPath).isDirectory()) { // 同下边 都改成lstatSync
                if (file === target) {
                    deleteFolder(curPath)
                } else {
                    deleteTargetFolder(curPath, target)
                }
            }
        })
    }
}

function deleteFolder (path) {
    var files = [];
    if (fs.existsSync(path)) {
        files = fs.readdirSync(path);
        files.forEach(function (file, index) {
            var curPath = path + "/" + file;
            //  本来网上是statSync 我给改成了 lstatSync
            if (fs.lstatSync(curPath).isDirectory()) {
                deleteFolder(curPath);
            } else {
                fs.unlinkSync(curPath);
            }
        });
        fs.rmdirSync(path);
    }
}