<!--
 * @Descripttion: 
 * @version: 
 * @Author: Chen
 * @Date: 2020-04-07 15:57:52
 * @LastEditors: Chen
 * @LastEditTime: 2020-05-13 11:54:42
 -->
<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="IE=edge, chrome=1" />
    <title>promise</title>
    <style>
      #container {
        width: 100%;
        height: 200px;
        line-height: 200px;
        text-align: center;
        color: #fff;
        background-color: #444;
        font-size: 30px;
      }
    </style>
  </head>

  <body>
    <!-- <script src="promise.js"></script> -->
    <script>
      //   new Promise((resolve) => {
      //     console.log(55555);
      //     setTimeout(() => {
      //       resolve(1);
      //     }, 500);
      //   })
      //     .then((res) => {
      //       console.log(res);
      //       return new Promise((resolve) => {
      //         setTimeout(() => {
      //           resolve(2);
      //         }, 500);
      //       });
      //     })
      //     .then((res) => {
      //       console.log(res);
      //     });

      Promise.any = (ps) =>
        new Promise((resolve, reject) => {
          let cnt = 0;
          ps.map((p) =>
            p.then(resolve).catch((err) => ++cnt === ps.length && reject(err))
          );
        });

      const resolveTimer = (ms) =>
        new Promise((r) => setTimeout(() => r(`${ms}$ elapsed`), ms));
      const rejectTimer = (ms) =>
        new Promise((_, r) => setTimeout(() => r(`${ms}$elapse`), ms));
      //   const timer = (ms) => (_, r) => setTimeout(() => r(`${ms}$elapse`), ms);
      Promise.any([
        resolveTimer(1000),
        resolveTimer(2000),
        resolveTimer(3000),
      ]).then(console.log);
      Promise.any([
        rejectTimer(1000),
        resolveTimer(2000),
        resolveTimer(3000),
      ]).then(console.log);
      Promise.any([rejectTimer(1000), rejectTimer(2000), rejectTimer(3000)])
        .then(console.log)
        .catch(console.log);
    </script>
  </body>
</html>
